"use strict";var AmexSDKConstants,AmexSDKLogging;!function(e){e.SRC_PROFILE="srcProfile",e.CORRELATION_ID="srccorrelationid",e.ACCESS_TOKEN="accesstoken",e.SRC_ID="consumerId",e.ID_TOKENS="idTokens",e.LOG_ID_TOKEN="LOG_ID_TOKEN",e.DPA_TRANSACTION_DATA="dpaTransactionOptions",e.DPA_DATA="dpaData",e.SRCI_DSA_ID="srciDpaId",e.TRANSACTION_ID="srciTransactionId",e.SRC_TRANSACTION_ID="srcsTransactionId",e.VERSION="sdk_version",e.INITIATOR_ID="srcInitiatorId",e.JSON_CONTENT_TYPE="application/json",e.EMAIL_ENC_LOOP_TIMES=1e3,e.AMEX_UNKOWN_RT="AMEX_UNKOWN_RT",e.API_TIMEOUT=1e4,e.INVALID_SRCI_ID="INVALID_SRCI_ID",e.MATCHED="MATCHED",e.NON_MATCHED="NON_MATCHED",e.MAT_NONMAT="MAT_NONMAT",e.MERCHANT_URL="merchantUrl",e.EXTENSIVE_LOGGING="extensiveLogging",e.CSRT_LOGGING="CSRT_LOGGING",e.SESSION_ID="session_id",e.INVALID_VERSION="invalid_version",e.THREEDS_TRANS_ID="threeDSServerTransID",e.PAYLOAD_TRANS_ID="payloadTransId",e.IGNORE_PAYLOAD="IGNORE_PAYLOAD",e.CSRT_EVENT="csrt_event_params",e.SDK_API_NAME={INIT:"init",IS_RECOGNIZED:"isRecognized",ID_LOOKUP:"identityLookup",GET_SRC_PROFILE:"getSrcProfile",INITIATE_ID_VALIDATION:"initiateIdentityValidation",COMPLETE_ID_VALIDATION:"completeIdentityValidation",CHECKOUT:"checkout",CHECKOUT_COMPLETE:"checkoutComplete",UNBIND:"unbindAppInstance"},e.DCF_PATH={ERROR:"/card-error",ADD_CARD:"/amex-card-details",SEND_OTP:"/verification-channel",REVIEW:"/review-and-confirm",CID:"/verify-the-card",BILLING:"/create-profile",SAFEKEY:"/safekey-challenge-result"};var n=function(){var e={},n=document.currentScript||document.querySelector('script[src*="amexSDK"]')||document.querySelector('script[src*="amexSS"]'),t="-qa",s=null,o="";if(n){var a=n.src,r=new URL(a);s=r.searchParams.get("env"),a.includes("cdaas-dev")?t="-dev":a.includes("qwww.aexp-static.com")?t="-qa":a.includes("www.aexp-static.com")&&(t=""),s&&(r.searchParams.delete("env"),t=s,a=String(r));var i=a.split("/").pop().split("-").pop().split(".");i.pop(),e.version=i.join(".")}return o="-dev"===t?"https://staging.cdn-net.com":"-qa"===t||"-green-qa"===t?"https://staging.cdn-net.com":"https://www.cdn-path.com",e.id="https://srcsidentity"+t+".americanexpress.com",e.pf="https://srcsprofile"+t+".americanexpress.com",e.ch="https://srcscheckout"+t+".americanexpress.com",e.dcf="https://srcdcf"+t+".americanexpress.com",e.log="https://srcservicing"+t+".americanexpress.com",e.csrt="https://srcservicing"+t+".americanexpress.com",e.keys="https://openid"+t+".americanexpress.com",e.safekey="https://srcsknotify"+t+".americanexpress.com",e.ping="https://srcskstatus"+t+".americanexpress.com",e.ia=o,e.epass=t,e.epaasRoute=s,e}();e.BASE_PROFILE_URL=n.pf,e.BASE_IDENTITY_URL=n.id,e.BASE_CHECKOUT_URL=n.ch,e.BASE_INAUTH_URL=n.ia,e.BASE_LOGGING_URL=n.log,e.BASE_CSRT_URL=n.csrt,e.BASE_KEYS_URL=n.keys,e.BASE_SAFEKEY_URL=n.safekey,e.BASE_PING_URL=n.ping,e.DCF_ENV=n.epass,e.EPAAS_ROUTE=n.epaasRoute,e.SDK_VERSION=n.version,e.CHECKOUT_RESPONSE="dcfActionCode",e.AMEX_DCF_URL=n.dcf,e.AMEX_SRCI_URL="*"}(AmexSDKConstants||(AmexSDKConstants={})),function(e){var n,t,s,o,a;(n=e.SplunkEventName||(e.SplunkEventName={})).Init="Init",n.IsRecognized="IsRecognized",n.GetSrcProfile="GetSrcProfile",n.IdLookup="IdLookup",n.InitIdValidation="InitIdValidation",n.CompleteIdValidation="CompleteIdValidation",n.Checkout="CheckoutStart",n.CheckoutComplete="CheckoutComplete",n.UnbindAppInstance="UnbindAppInstance",(t=e.SplunkApiName||(e.SplunkApiName={})).Init="Init",t.IsRecognized="IsRecognized",t.GetSrcProfile="GetSrcProfile",t.IdLookup="IdLookup",t.InitIdValidation="InitIdValidation",t.CompleteIdValidation="CompleteIdValidation",t.Checkout="Checkout",t.UnbindAppInstance="UnbindAppInstance",(s=e.SplunkEventStatus||(e.SplunkEventStatus={})).Success="SCS",s.Fail="FAL",(o=e.PromiseStatus||(e.PromiseStatus={})).Reject="REJ",o.Resolve="RES",(a=e.CsrtFieldName||(e.CsrtFieldName={})).sdk_err_cd="sdk_err_cd",a.sdk_err_desc="sdk_err_desc",a.is_recognized="is_recog",a.consumer_identity_value="consumer_identity_value",a.consumer_present="cons_present",a.supported_validation_channels_type="supported_validation_chan_type",a.masked_validation_channel="masked_validation_chan",a.auth_code_value="auth_code_val",a.no_of_profiles_returned="no_of_profiles_returned",a.matched_rt_cnt="matched_rt_cnt",a.non_matched_rt_cnt="non_matched_rt_cnt",a.src_digital_card_Id="src_digital_card_Id",a.encrypted_card="encrypted_card",a.dcf_action_code="dcf_act_cd",a.checkout_response_signature="checkout_response_sign",a.unbind_app_instance="unbind_app_inst",a.unbind_idtoken_cnt="unbind_idtoken_cnt"}(AmexSDKLogging||(AmexSDKLogging={}));var AmexUtils,AmexErrorCodes,AmexWindow,__assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,s=arguments.length;t<s;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},SRC_TRANSACTION_ID=AmexSDKConstants.SRC_TRANSACTION_ID,INITIATOR_ID=AmexSDKConstants.INITIATOR_ID,ACCESS_TOKEN=AmexSDKConstants.ACCESS_TOKEN,LOG_ID_TOKEN=AmexSDKConstants.LOG_ID_TOKEN,BASE_LOGGING_URL=AmexSDKConstants.BASE_LOGGING_URL,SplunkEventName=AmexSDKLogging.SplunkEventName,DPA_TRANSACTION_DATA=AmexSDKConstants.DPA_TRANSACTION_DATA,CORRELATION_ID=AmexSDKConstants.CORRELATION_ID,VERSION=AmexSDKConstants.VERSION,TRANSACTION_ID=AmexSDKConstants.TRANSACTION_ID,DPA_DATA=AmexSDKConstants.DPA_DATA,CSRT_EVENT=AmexSDKConstants.CSRT_EVENT,CSRT_LOGGING=AmexSDKConstants.CSRT_LOGGING,EXTENSIVE_LOGGING=AmexSDKConstants.EXTENSIVE_LOGGING,BASE_CSRT_URL=AmexSDKConstants.BASE_CSRT_URL,loggingQueue=[],logSplunkEventInQueue=function(){try{0<loggingQueue.length&&(loggingQueue.map(function(e){callLogger(e)}),loggingQueue=[])}catch(e){console.log(e)}},callLogger=function(e){try{var n=window.amexSrcInstance.getItem(SRC_TRANSACTION_ID)||"",t=window.amexSrcInstance.getItem(INITIATOR_ID)||"",s=window.amexSrcInstance.getItem(ACCESS_TOKEN)||"",o=window.amexSrcInstance.getItem(LOG_ID_TOKEN)||"",a=JSON.parse(window.amexSrcInstance.getItem(DPA_TRANSACTION_DATA)||"{}"),r="";a&&a.dpaLocale&&(r=a.dpaLocale);var i=new XMLHttpRequest;e.event.SrcsTransactionId=n,e.event.SrciInitiatorId=t,i.open("POST",BASE_LOGGING_URL+"/v2/logger"),i.setRequestHeader("Accept","*/*"),i.setRequestHeader("Accept-Language","en"),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("SrcsTransactionId",n),e.event.eventName===SplunkEventName.Init?i.setRequestHeader("ApplicationName","src_init"):e.event.eventName===SplunkEventName.IsRecognized?i.setRequestHeader("ApplicationName","src_isRecognized"):e.event.eventName===SplunkEventName.GetSrcProfile&&(e.event.dpaLocale=r),o?i.setRequestHeader("IdToken",o):s&&i.setRequestHeader("AccessToken",s),i.send(JSON.stringify(e))}catch(e){console.log(e)}};!function(e){var t=AmexSDKConstants.ACCESS_TOKEN,o=AmexSDKConstants.CSRT_EVENT;function n(e){return!e}function a(e){if(!e)return!0;for(var n in e)if(e.hasOwnProperty(n))return!1;return JSON.stringify(e)===JSON.stringify({})}e.storeHeader=function(e,n){e&&e.getResponseHeader(n)&&(window.amexSrcInstance.setItem(n,e.getResponseHeader(n)||""),n===t&&logSplunkEventInQueue())},e.add=function(e,n){return e+n},e.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})},e.generateSRCUUID=function(){return"SRC-xxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})},e.responsePromise=function(e){return delete e.resolveIndex,delete e.resolve,e.pandaYellow&&delete e.pandaYellow,e},e.isValidLuhn=function(e){var n,t,s,o,a=0;for(t=0,s=(o=e.split("").reverse().join("")).length;t<s;t++)n=+(n=o[t]),a+=t%2?(n*=2)<10?n:n-9:n;return a%10==0},e.cardYearMothValidation=function(e,n){var t=new Date;return t.setFullYear(Number(n),Number(e)-1,t.getDate()+1),t.getTime()>(new Date).getTime()},e.isCreditCard=function(e){if(19<e.length)return!1;for(var n=0,t=1,s=e.length,o=0;o<s;o++){var a=e.substring(s-o-1,s-o),r=parseInt(a,10)*t;n+=10<=r?r%10+1:r,1===t?t++:t--}return n%10==0},e.getTimeStamp=function(){return(new Date).getTime()},e.isEmptyString=n,e.isEmpty=function(e){return n(e)||a(e)},e.isEmptyObject=a,e.checkArrayOfStrings=function(e){return e.every(function(e){return"string"==typeof e})},e.getPropertyFromToken=function(e,n){var t=e&&JSON.parse(atob(e.split(".")[1]));return t&&t[n]?t[n]:null},e.getNavigatorLanguage=function(){return navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||""},e.stringToBool=function(e){return"true"==e},e.objectToBase64=function(e){return btoa(JSON.stringify(e))},e.initalizeCsrtEvent=function(e){var n;window.amexSrcInstance.setItem(o,JSON.stringify(((n={})[e]={},n)))},e.updateCsrtEvent=function(e,n,t){var s=JSON.parse(window.amexSrcInstance.getItem(o)||"{}");s&&!a(s)&&(s[t][e]=n),window.amexSrcInstance.setItem(o,JSON.stringify(s))},e.getChannelTypes=function(e){try{var n=[];return e&&e.forEach(function(e){-1===n.indexOf(e.validationType)&&n.push(e.validationType)}),n.length?n.join(" | "):null}catch(e){}}}(AmexUtils||(AmexUtils={})),(AmexErrorCodes||(AmexErrorCodes={})).SDKErrorCodes={standardErrorCodes:{REQUEST_TIMEOUT:{reason:"REQUEST_TIMEOUT",message:"Service Timeout occurred"},SERVER_ERROR:{reason:"SERVER_ERROR",message:"General server error"},INVALID_PARAMETER:{reason:"INVALID_PARAMETER",message:"Request to the Service contains invalid parameters"}},init:{SRCI_ID_MISSING:{reason:"SRCI_ID_MISSING",message:"The identifier for the SRC Initiator is missing."},DSA_ID_MISSING:{reason:"DPA_ID_MISSING",message:"Both srciDpaId & srcDpaId is missing. There would be no way for an SRC System to identify the DPA."},SRCI_TXN_ID_MISSING:{reason:"SRCI_TXN_ID_MISSING",message:"srciTransactionId is missing."},VERSION_MISSING:{reason:"INVALID_VERSION_PARAMETER",message:"Version parameter is missing or invalid."}},identityLookup:{FRAUD:{reason:"FRAUD",message:"The user account was locked or disabled."},ID_FORMAT_UNSUPPORTED:{reason:"ID_FORMAT_UNSUPPORTED",message:"Unsupported Id format"},CONSUMER_ID_MISSING:{reason:"CONSUMER_ID_MISSING",message:"Consumer identity is missing in the request"},ACCT_INACCESSIBLE:{reason:"ACCT_INACCESSIBLE",message:"The account exists but is not currently accessible (e.g. is locked)"}},getSrcProfile:{AUTH_INVALID:{reason:"AUTH_INVALID",message:"Invalid Authorization"},ACCT_INACCESSIBLE:{reason:"ACCT_INACCESSIBLE",message:"The account exists but is not currently accessible (e.g. is locked)"},EMPTY_PROFILES:{reason:"EMPTY_PROFILES",message:"There are no profiles for received idTokens"}},initiateIdentityValidation:{OPT_SEND_FAILED:{reason:"OPT_SEND_FAILED",message:"The OTP could not be sent to the recipient."},RETRIES_EXCEEDED:{reason:"RETRIES_EXCEEDED",message:"The limit for the number of retries for OTP generation was exceeded."},ID_INVALID:{reason:"ID_INVALID",message:"Invalid ID."},UNRECOGNIZED_CONSUMER_ID:{reason:"UNRECOGNIZED_CONSUMER_ID",message:"Consumer ID could not be recognized."},ACCT_INACCESSIBLE:{reason:"ACCT_INACCESSIBLE",message:"The account exists but is not currently accessible (e.g. is locked)"}},completeIdentityValidation:{VALIDATION_DATA_MISSING:{reason:"VALIDATION_DATA_MISSING",message:"Validation data missing."},CODE_INVALID:{reason:"CODE_INVALID",message:"The supplied OTP value was invalid. Try again."},CODE_EXPIRED:{reason:"CODE_EXPIRED",message:"The OTP is expired. Regenerate the OTP and try again."},RETRIES_EXCEEDED:{reason:"RETRIES_EXCEEDED",message:"The limit for the number of retries for OTP generation was exceeded."},ACCT_INACCESSIBLE:{reason:"ACCT_INACCESSIBLE",message:"The account exists but is not currently accessible (e.g. is locked)"}},checkout:{CARD_ADD_FAILED:{reason:"CARD_ADD_FAILED",message:"Unable to add card."},CARD_SECURITY_CODE_MISSING:{reason:"CARD_SECURITY_CODE_MISSING",message:"Card security must be supplied."},CARD_INVALID:{reason:"CARD_INVALID",message:"Invalid card number."},CARDID_MISSING:{reason:"CARDID_MISSING",message:"The card ID was required but is missing."},CARD_EXP_INVALID:{reason:"CARD_EXP_INVALID",message:"Invalid card expiry date."},ACCT_INACCESSIBLE:{reason:"ACCT_INACCESSIBLE",message:"The account exists but is not currently accessible (e.g. is locked)"},UNABLE_TO_CONNECT:{reason:"UNABLE_TO_CONNECT",message:"Unable to connect to DCF."}},unbindAppInstance:{AUTH_INVALID:{reason:"AUTH_INVALID ",message:"Invalid Authorization "},CONSUMER_INACCESSIBLE:{reason:"CONSUMER_INACCESSIBLE ",message:"The consumer exists but is not currently accessible"},RT_VERIFICATION_FAILED:{reason:"RT_VERIFICATION_FAILED ",message:"Refresh token verification failed."},ID_TOKEN_VERIFICATION_FAILED:{reason:"ID_TOKEN_VERIFICATION_FAILED ",message:"Id token verification failed"}}},function(e){var a=function(){return self===top?window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth:window.outerWidth||window.screen.width},r=function(){return self===top?window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight:window.outerHeight||window.screen.height};e.openAmexPopUp=function(e){var n=0,t=0;window.screenX?n=window.screenX:window.screenLeft?n=window.screenLeft:window.screen.left&&(n=window.screen.left),window.screenY?t=window.screenY:window.screenTop?t=window.screenTop:window.screen.top&&(t=window.screen.top);var s=n+a()/2-217.5,o=t+r()/2-337.5;return 1==function(e){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera)?window.open(e,"dcfWindowRef","toolbar=no,menubar=no,location=no,resizable=yes,status=no,top=0, left=0,width="+window.innerWidth+", height=675"):window.open(e,"dcfWindowRef","toolbar=no,menubar=no,location=no,resizable=yes,status=no,top="+o+", left="+s+",width=435, height=675")}}(AmexWindow||(AmexWindow={}));var AmexSDK,__assign$1=function(){return(__assign$1=Object.assign||function(e){for(var n,t=1,s=arguments.length;t<s;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};window.amexSrcInstance=function(){var t={};return{getItem:function(e){return t[e]},setItem:function(e,n){t[e]=n.toString()},clear:function(){t={}},removeItem:function(e){delete t[e]},getAll:function(){return t}}}(),function(e){var s=AmexSDKConstants.SDK_VERSION,r=AmexSDKLogging.PromiseStatus,c=AmexSDKConstants.SDK_API_NAME,d=AmexSDKConstants.DCF_PATH,o=AmexSDKConstants.AMEX_DCF_URL,a=AmexSDKConstants.EPAAS_ROUTE,u=AmexUtils.getTimeStamp,t=AmexSDKLogging.SplunkApiName,m=AmexSDKLogging.SplunkEventName,p=AmexSDKLogging.SplunkEventStatus,l=AmexErrorCodes.SDKErrorCodes,S=l.standardErrorCodes,n=function(){function i(){window.addEventListener?window.addEventListener("message",this.receiveMessage,!1):window.attachEvent("onmessage",this.receiveMessage,!1)}return i.getInstance=function(){return this.amexSRC||(this.amexSRC=new i,this.merchantURL=i.getMerchanturl(),this.createIFrame()),this.amexSRC},i.getLocalStorage=function(){var e={method:"DATA_REQUIRED"};i.postMessages(e,null,null)},i.notifyCreq=function(e){var n={method:"notifyCreq",_method:"notifyCreq"};n.request=e,i.postMessages(n,null,null)},i.inVoke3ds=function(e){var n={method:"inVoke3ds",_method:"inVoke3ds"};n.data=e,i.postMessages(n,null,null)},i.AmexLog=function(){console.log("Amex Logs",this.AmexLogObject)},i.logSplunkEvent=function(e){var n;try{if(!e)return;var t={sourcetype:"src_audit",event:{merchantName:this.merchantName,eventName:e.eventName,eventOrigin:"SDK",eventStartTimestamp:e.eventStartTimestamp||null,eventEndTimestamp:e.eventEndTimestamp||u(),eventStatus:e.eventStatus,sdkApiName:e.sdkApiName,backendApiName:"",userActivityName:"",userActivityTimestamp:null,previousPage:"merchant",currentPage:"merchant",payload:{request:e.request,response:e.response}}};if(t.event.eventName===m.Init&&(t.event.merchantUrl=i.merchantURL,t.event.userAgent=navigator?navigator.userAgent:""),this.logging){var s={method:"LOG_API"};s.data=t,s.isInitReject=e.promiseStatus===r.Reject,i.postMessages(s,null,null)}window.AMEX_LOG&&(this.AmexLogObject=__assign$1({},this.AmexLogObject,((n={})[e.sdkApiName]={request:e.request,response:e.response?e.response:"PENDING"},n)),this.AmexLog())}catch(e){console.log(e)}},i.getMerchanturl=function(){try{return window.top&&window.top.location?window.top.location.host:""}catch(e){return console.log("Window access denied"),""}},i.createIFrame=function(){var e=document.createElement("iframe");e.frameBorder="0",e.width="0px",e.height="0px",e.id="ssIframe",e.name="ssIframe";var n=null;try{n=(document.currentScript||document.querySelector('script[src*="amexSDK"]')||document.querySelector('script[src*="amexSS"]')).src}catch(e){}var t=AmexSDKConstants.AMEX_DCF_URL+"/iframe.html?v="+s;n.includes("sandbox")&&(t+="&sandbox=true"),a&&(t=t+"&env="+a),e.setAttribute("src",t),e.setAttribute("style","display:none;position:absolute;width:0px;height:0px;border:none;left:-100px;top:-100px;"),document.body.appendChild(e)},i.postMessages=function(e,n,t){if(!this.ssIframe){var s=document.getElementById("ssIframe");try{this.ssIframe=s.contentWindow}catch(e){this.ssIframe=s.contentWindow}}n&&(i.resolve.push(n),e.resolveIndex=i.resolve.indexOf(n)),t&&i.reject.push(t);try{this.ssIframe.postMessage(JSON.stringify(e),o)}catch(e){console.log(e)}},i.prototype.checkoutCompleteMessage=function(s){return new Promise(function(e,n){var t={method:c.CHECKOUT_COMPLETE,request:s};i.postMessages(t,e,n)})},i.prototype.ready=function(){return new Promise(function(e,n){var t={method:"READY"},s=setInterval(function(){i.amexReady&&(clearInterval(s),i.postMessages(t,e,n))},500)})},i.prototype.logSession=function(){var e={method:"LOG_SESSION"};i.postMessages(e)},i.prototype.init=function(o){var a={eventName:m.Init,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.Init,request:o,response:{}};window.amexSrcInstance.clear();try{o&&o.dpaData&&(i.merchantName=o.dpaData.dpaPresentationName||"")}catch(e){}return new Promise(function(n,t){var e={request:o,method:c.INIT,merchantUrl:i.merchantURL,extensiveLogging:i.extensiveLogging,csrtLogging:i.csrtLogging},s=setInterval(function(){i.amexReady&&(clearInterval(s),i.postMessages(e,function(e){a.response=e.response,i.logSplunkEvent(a),n()},function(e){var n=e.response;a.promiseStatus=r.Reject,n.reason||(a.eventStatus=p.Fail),a.response=n,i.logSplunkEvent(a),t(n)}))},500)})},i.prototype.isRecognized=function(){var o={eventName:m.IsRecognized,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.IsRecognized,request:{},response:{}};return new Promise(function(t,s){var e={method:c.IS_RECOGNIZED,request:null};i.postMessages(e,function(e){var n=e.response;t(n),o.response=n,i.logSplunkEvent(o)},function(e){var n=e.response;s(n),o.eventStatus=p.Fail,o.response=n,i.logSplunkEvent(o)})})},i.prototype.identityLookup=function(s){var o={eventName:m.IdLookup,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.IdLookup,request:s,response:{}};return i.invitation_id&&(s.invitation_id=i.invitation_id),new Promise(function(n,t){var e={request:s,method:c.ID_LOOKUP};i.postMessages(e,function(e){n(e.response),o.response=e.response,i.logSplunkEvent(o)},function(e){!function(e){t(e),e.reason&&e.reason!==S.SERVER_ERROR.reason&&e.reason!==S.REQUEST_TIMEOUT.reason||(o.eventStatus=p.Fail),o.response=e,i.logSplunkEvent(o)}(e.response)})})},i.prototype.getSrcProfile=function(s){var o={eventName:m.GetSrcProfile,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.GetSrcProfile,request:s,response:{}};return new Promise(function(t,n){var e={method:c.GET_SRC_PROFILE,request:s};i.postMessages(e,function(e){var n=e.response;t(n),o.response=n,i.logSplunkEvent(o)},function(e){!function(e){n(e),(o.response=e).reason&&e.reason!==S.SERVER_ERROR.reason&&e.reason!==S.REQUEST_TIMEOUT.reason||(o.eventStatus=p.Fail),e&&e.reason===l.getSrcProfile.EMPTY_PROFILES.reason&&(o.eventStatus=p.Success),i.logSplunkEvent(o)}(e.response)})})},i.prototype.checkout=function(o){i.invitation_id&&(o.invitation_id=i.invitation_id);var a=__assign$1({},o);a.windowRef=o.windowRef?"windowRef":"",o.windowRef||(i.amexPopUp=AmexWindow.openAmexPopUp(""),o.windowRef=i.amexPopUp),o.windowRef.location||(i.isPopup=!1);var r={eventName:m.Checkout,eventStartTimestamp:u(),eventEndTimestamp:u(),eventStatus:p.Success,sdkApiName:t.Checkout,request:a,response:{}};return new Promise(function(t,s){if(!o.encryptedCard&&!o.srcDigitalCardId){var e=S.INVALID_PARAMETER;return s(e),r.response=e,void i.logSplunkEvent(r)}i.checkoutResolve=function(e){r.response=__assign$1({},e),r.eventStartTimestamp=u(),r.eventEndTimestamp=u(),r.eventName=m.CheckoutComplete,r.eventStatus=p.Success;var n=e.response;t(n),i.logSplunkEvent(r)},i.checkoutReject=function(e){r.response=__assign$1({},e),r.eventName=m.CheckoutComplete,r.eventStatus=p.Fail;var n=e.response;s(n),i.logSplunkEvent(r)};var n={method:c.CHECKOUT,request:a};i.postMessages(n,function(e){i.logSplunkEvent(r);var n=e.response;if(n&&n.nextStep){i.isPopup?o.windowRef.location.href=AmexSDKConstants.AMEX_DCF_URL+n.nextStep:o.windowRef.src=AmexSDKConstants.AMEX_DCF_URL+n.nextStep;var t={srcProfile:n.srcProfile};i.dcfData=JSON.stringify(t),i.dcfRef=o.windowRef}},function(e){var n=e.response;if(n.reason===l.checkout.ACCT_INACCESSIBLE.reason){i.isPopup?o.windowRef.location.href=AmexSDKConstants.AMEX_DCF_URL+d.ERROR:o.windowRef.src=AmexSDKConstants.AMEX_DCF_URL+d.ERROR;var t={srcProfile:n.srcProfile};i.dcfData=JSON.stringify(t),i.dcfRef=o.windowRef}else s(n),(r.response=n).reason&&n.reason!==S.SERVER_ERROR.reason||(r.eventStatus=p.Fail),i.logSplunkEvent(r)})})},i.prototype.initiateIdentityValidation=function(n){var o={eventName:m.InitIdValidation,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.InitIdValidation,request:n,response:{}};return new Promise(function(t,s){var e={method:c.INITIATE_ID_VALIDATION,request:n};i.postMessages(e,function(e){var n=e.response;t(n),o.response=n,i.logSplunkEvent(o)},function(e){var n=e.response;s(n),(o.response=n).reason&&n.reason!==S.SERVER_ERROR.reason&&n.reason!==S.REQUEST_TIMEOUT.reason||(o.eventStatus=p.Fail),i.logSplunkEvent(o)})})},i.prototype.completeIdentityValidation=function(s){var o={eventName:m.CompleteIdValidation,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.CompleteIdValidation,request:s,response:{}};return new Promise(function(t,n){var e={request:s,method:c.COMPLETE_ID_VALIDATION};i.postMessages(e,function(e){var n=e.response;t(n),o.response=n,i.logSplunkEvent(o)},function(e){!function(e){n(e),(o.response=e).reason&&e.reason!==S.SERVER_ERROR.reason&&e.reason!==S.REQUEST_TIMEOUT.reason||(o.eventStatus=p.Fail),i.logSplunkEvent(o)}(e.response)})})},i.prototype.unbindAppInstance=function(s){var o={eventName:m.UnbindAppInstance,eventStartTimestamp:u(),eventStatus:p.Success,sdkApiName:t.UnbindAppInstance,request:s,response:{}};return new Promise(function(t,n){var e={method:c.UNBIND,request:s};i.postMessages(e,function(e){var n=e.response;t(n),o.response=n,i.logSplunkEvent(o)},function(e){!function(e){n(e),(o.response=e).reason&&e.reason!==S.SERVER_ERROR.reason&&e.reason!==S.REQUEST_TIMEOUT.reason||(o.eventStatus=p.Fail),i.logSplunkEvent(o)}(e.response)})})},i.prototype.receiveMessage=function(e){try{if(e.origin!==AmexSDKConstants.AMEX_DCF_URL)return;var n="string"==typeof e.data?JSON.parse(e.data):e.data,t=n.eventName,s=n.eventData;if("DCF_READY"===t){if(i.dcfRef&&i.dcfData){var o={eventName:"LOG_EVENTS",eventValue:{logging:i.logging,extensiveLogging:i.extensiveLogging,csrtLogging:i.csrtLogging}};i.isPopup?(i.dcfRef.postMessage(JSON.stringify(o),AmexSDKConstants.AMEX_DCF_URL),i.dcfRef.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL)):(i.dcfRef.contentWindow.postMessage(JSON.stringify(o),AmexSDKConstants.AMEX_DCF_URL),i.dcfRef.contentWindow.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL))}i.dcfData=null}else{if("DCF_DATA_REQUIRED"===t)return void i.getLocalStorage();if("AMEX_READY"===t)i.amexReady=!0;else if("DATA_REQUIRED_RESPONSE"===t)i.dcfData=n,i.isPopup?i.dcfRef.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL):i.dcfRef.contentWindow.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL);else if("DCF_CREQ_NO_RESPONSE"===t)i.dcfData=n,i.isPopup?i.dcfRef.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL):i.dcfRef.contentWindow.postMessage(i.dcfData,AmexSDKConstants.AMEX_DCF_URL);else if("DCF_INVOKE_3DS"===t)i.inVoke3ds(s);else if("DCF_CREQ_REQUEST"===t)i.dcfData=n;else if("DCF_NOTIFY_CREQ"===t)i.notifyCreq(s);else if("DCF_CHECKOUT_RESPONSE"===t){var a=s;e.data;i.amexPopUp&&i.amexPopUp.close(),i.amexSRC.checkoutCompleteMessage(a).then(function(e){i.checkoutResolve(e)}).catch(function(e){i.checkoutReject(e)})}else if(void 0!==e.data.resolveIndex){var r=e.data;!0===e.data.resolve?i.resolve[r.resolveIndex](r):i.reject[r.resolveIndex](r)}}}catch(e){}},i.logging=!0,i.invitation_id=null,i.extensiveLogging=!1,i.csrtLogging=!0,i.resolve=[],i.reject=[],i.dcfData=null,i.dcfRef=null,i.amexReady=!1,i.isPopup=!0,i.amexPopUp=null,i.checkoutResolve=null,i.checkoutReject=null,i.merchantName="",i.merchantURL="",i.AmexLogObject={},i.ssIframe=null,i}();(e.AmexSRC=n).getInstance()}(AmexSDK||(AmexSDK={})),window.AmexSS={getInstance:function(){return AmexSDK.AmexSRC.getInstance()},loggingStatus:function(){return AmexSDK.AmexSRC.logging},enableLogging:function(){AmexSDK.AmexSRC.logging=!AmexSDK.AmexSRC.logging},authenticateSession:function(e){AmexSDK.AmexSRC.invitation_id=e}};